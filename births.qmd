---
editor_options: 
  chunk_output_type: console
editor:
  markdown:
    canonical: true  
---

# Births

Compare sources of births data.
Construct birth estimates.

## Setup
```{r}
#| label: setup

source(here::here("setup.R"))
```


```{r}
#| label: constants

mage_order <- c(
  "<15",
  "15-17",
  "18-19",
  "20-24",
  "25-29",
  "30-34",
  "35-39",
  "40-44",
  "45+",
  "Unknown",
  "Total"
)

```

## Get and smooth Census data on births

```{r}

df <- readRDS(fs::path(DWORK, "coclong.rds"))
glimpse(df)


```

### Explore Census births data

```{r}
cnty <- "Westchester" # Albany Saratoga Washington Westchester
check <- df |>
  filter(
    stfips == "36",
    # cntyfips == "115",
    shortname == cnty,
    year %in% 2020:2024,
    str_detect(variable, "birth") | variable == "pop"
  ) |>
  select(shortname, year, vtype, variable, value) |>
  mutate(variable = ifelse(vtype == "rate", paste0("r", variable), variable)) |>
  select(-vtype) |>
  pivot_wider(names_from = variable) |>
  arrange(year) |>
  mutate(
    r0 = births / pop * 1000,
    rlag = births / lag(pop) * 1000,
    rlead = births / lead(pop) * 1000
  )
check

```

### Interpolate and adjust Census births data
